---
layout: default
---

<article class="recipe-single">
    <header class="recipe-header">
        <h1 class="recipe-title">{{ page.title }}</h1>
        {% if page.description %}
            <p class="recipe-description">{{ page.description }}</p>
        {% endif %}
    </header>

    {% comment %} Liquid do dzielenia treści na sekcje {% endcomment %}
    {% assign full_content_html = content %}

    {% comment %} Dzielimy całość na blok "Składniki" i resztę po "Przygotowanie" {% endcomment %}
    {% assign parts_by_prep = full_content_html | split:'<h2>Przygotowanie:</h2>' %}
    {% assign ingredients_block_html = parts_by_prep[0] %} {% comment %} Zawiera Składniki:<h2> i <ul> {% endcomment %}

    {% comment %} Dzielimy resztę na blok "Przygotowanie" i "Uwagi" {% endcomment %}
    {% assign remaining_content = parts_by_prep[1] %}
    {% assign parts_by_notes = remaining_content | split:'<h2>Uwagi:</h2>' %}
    
    {% assign preparation_block_html = '<h2>Przygotowanie:</h2>' | append: parts_by_notes[0] %} {% comment %} Zawiera Przygotowanie:<h2> i <ol> {% endcomment %}

    {% assign notes_block_html = '' %}
    {% if parts_by_notes[1] %}
      {% assign notes_block_html = '<h2>Uwagi:</h2>' | append: parts_by_notes[1] %} {% comment %} Zawiera Uwagi:<h2> i <p> {% endcomment %}
    {% endif %}

    <div class="recipe-content-wrapper">
        <aside class="recipe-main-info">
            {% comment %} Logika wyświetlania obrazka {% endcomment %}
            {% assign default_placeholder_path = '/images/general/placeholder-recipe.jpg' %}
            {% assign final_image_path = page.image_main | default: site.data.placeholders.recipe_image | default: default_placeholder_path %}
            
            <img src="{{ final_image_path | relative_url }}" alt="{{ page.title | default: 'Brak zdjęcia przepisu' }}" class="recipe-main-image">
            
            {% comment %} Ukrywamy sekcję recipe-details na razie {% endcomment %}
            {% comment %}
            <div class="recipe-details">
                {% if page.time %}
                    <p><strong>Czas przygotowania:</strong> {{ page.time }}</p>
                {% endif %}
                {% if page.servings %}
                    <p><strong>Liczba porcji:</strong> {{ page.servings }}</p>
                {% endif %}
                {% if page.difficulty %}
                    <p><strong>Poziom trudności:</strong> {{ page.difficulty }}</p>
                {% endif %}
            </div>
            {% endcomment %}
        </aside>

        {% comment %} Sekcja Składniki (na prawo od obrazka na desktopie) {% endcomment %}
        <div class="recipe-ingredients-side">
            {{ ingredients_block_html }}
        </div>

        {% comment %} Sekcje Przygotowanie i Uwagi (pod obrazkiem, na całą szerokość) {% endcomment %}
        <div class="recipe-main-content">
            {{ preparation_block_html }}
            {{ notes_block_html }}
        </div>
    </div>

    <div class="button-container recipe-single-button-container">
        {% comment %} Przycisk "Drukuj przepis" przeniesiony tutaj {% endcomment %}
        <button class="print-button button secondary-button" onclick="window.print()" aria-label="Drukuj przepis">Drukuj przepis</button>

        {% if page.category %}
            {% assign category_name = "" %}
            {% for cat in site.data.categories %}
                {% if cat.slug == page.category %}
                    {% assign category_name = cat.name %}
                    {% break %}
                {% endif %}
            {% endfor %}
            
            <a href="{{ '/categories/' | relative_url }}{{ page.category }}.html" class="button primary-button" aria-label="Wróć do przepisów w kategorii {{ category_name | default: page.category | escape }}">
                « {{ category_name | default: 'Kategoria' }}
            </a>
        {% endif %}
        
        <a href="{{ '/' | relative_url }}#kategorie" class="button primary-button" aria-label="Wróć do wszystkich kategorii na stronie głównej">
            Wszystkie kategorie
        </a>
    </div>

    {% comment %} Sekcja daty aktualizacji/publikacji na dole {% endcomment %}
    <div class="recipe-footer-meta">
        {% if page.last_modified_at %}
            <p class="recipe-date">Ostatnia aktualizacja: <time datetime="{{ page.last_modified_at | date_to_xmlschema }}">{{ page.last_modified_at | date: "%d %b %Y" }}</time></p>
        {% elsif page.date %}
            <p class="recipe-date">Opublikowano: <time datetime="{{ page.date | date_to_xmlschema }}">{{ page.date | date: "%d %b %Y" }}</time></p>
        {% endif %}
    </div>

</article>

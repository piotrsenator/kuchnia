---
layout: default
permalink: /category/:category/
---

<div class="content">
    <header class="page-header">
        {# Pobieramy slug kategorii z URL-a (np. "dania-glowne-miesne") #}
        {% assign category_slug = page.category %}
        
        {# Formatujemy slug na czytelną nazwę (np. "Dania Główne Mięsne") #}
        {% assign category_name_formatted = category_slug | replace: '-', ' ' | replace: '_', ' ' | capitalize %}
        
        {# Dodatkowo, spróbujmy znaleźć opis kategorii z _data/categories.yml #}
        {% assign current_category_data = site.data.categories | where: "slug", category_slug | first %}

        <h1>Kategoria: {{ category_name_formatted }}</h1>
        {% if current_category_data.description %}
            <p class="page-description">{{ current_category_data.description }}</p>
        {% else %}
            <p class="page-description">Wszystkie przepisy w kategorii {{ category_name_formatted }}.</p>
        {% endif %}
    </header>

    <section class="recipes-grid-section">
        <h2 class="section-title">Przepisy</h2>
        <div class="recipes-grid">
            {% comment %} 
            Ręczne filtrowanie przepisów ze względu na problemy z Liquid 'where_exp' na GitHub Pages.
            Iterujemy po wszystkich przepisach i sprawdzamy ich kategorię/kategorie.
            {% endcomment %}
            {% assign recipes_found_in_category = false %}
            
            {# Linia 25 zaczyna się tutaj: #}
            {% for recipe in site.recipes %}
                {% assign is_in_category = false %}
                
                {# Sprawdź, czy pole 'category' przepisu pasuje do aktualnego sluga #}
                {% if recipe.category == category_slug %}
                    {% assign is_in_category = true %}
                {% endif %}
                
                {# Sprawdź, czy tablica 'categories' przepisu (jeśli istnieje) zawiera aktualny slug #}
                {% if recipe.categories %}
                    {% if recipe.categories contains category_slug %}
                        {% assign is_in_category = true %}
                    {% endif %}
                {% endif %}

                {# Jeśli przepis należy do tej kategorii, wyświetl go #}
                {% if is_in_category %}
                    {% include recipe_card.html recipe=recipe %}
                    {% assign recipes_found_in_category = true %}
                {% endif %}
            {% endfor %}
            
            {# Jeśli po pętli nie znaleziono żadnych przepisów, wyświetl komunikat #}
            {% unless recipes_found_in_category %}
                <p>Brak przepisów w tej kategorii.</p>
            {% endunless %}
        </div>
    </section>
    
    <div class="button-container">
        <a href="{{ '/categories/' | relative_url }}" class="button secondary-button">Wróć do wszystkich kategorii</a>
    </div>
</div>
